{% extends 'base.html' %}

{% block content %}
<div class="container py-5 mt-5 fade-in">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6 text-center">
            <div class="card border-0 shadow-lg p-5 rounded-5 glass-card">
                <div class="mb-4">
                    <i class="bi bi-shield-check-fill display-1 text-success"></i>
                </div>

                <h2 class="fw-bold mb-3" style="color: var(--burgundy);">Pedido #{{ order.id }} Gerado!</h2>
                <p class="text-muted mb-4">
                    Sua reserva foi concluída com sucesso. Agora, vamos te direcionar para o
                    <strong>ambiente seguro de pagamento</strong> do nosso parceiro Asaas.
                </p>

                <div class="d-flex align-items-center justify-content-center mb-4">
                    <div class="spinner-border text-burgundy me-3" role="status" style="width: 1.5rem; height: 1.5rem;"></div>
                    <span class="fw-bold text-muted">Redirecionando em <span id="timer">5</span>s...</span>
                </div>

                <div class="alert alert-light border-0 small text-muted mb-4">
                    <i class="bi bi-lock-fill me-1"></i>
                    Pagamento processado com criptografia de 256 bits.
                </div>

                <a href="{{ payment_url }}" class="btn btn-burgundy btn-lg w-100 py-3 fw-bold shadow">
                    Ir para Pagamento Agora
                </a>
            </div>

            <p class="mt-4 text-muted small">
                Problemas no redirecionamento? <a href="{{ payment_url }}" class="text-burgundy fw-bold">Clique aqui</a>.
            </p>
        </div>
    </div>
</div>

<script>
    // Lógica do Contador e Redirecionamento Automático
    let seconds = 5;
    const timerDisplay = document.getElementById('timer');
    const paymentUrl = "{{ payment_url }}";

    const countdown = setInterval(() => {
        seconds--;
        timerDisplay.innerText = seconds;
        if (seconds <= 0) {
            clearInterval(countdown);
            window.location.href = paymentUrl;
        }
    }, 1000);
</script>

<style>
    .text-burgundy { color: var(--burgundy); }
    .glass-card {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.3);
    }
</style>
{% endblock %}